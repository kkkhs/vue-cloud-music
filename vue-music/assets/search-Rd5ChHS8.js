import{D as ut,E as dt,G as wt,S as A,q as k,H as q,I as ht,o as w,c as h,d as u,B,i as n,w as $,J as ft,b as i,K as Y,z as P,p as G,L as T,a as E,x as X,r as Z,F as L,l as V,u as rt,t as U,A as K,M as F,N as pt,O as vt,e as g,P as _t,Q as z,h as D,R as yt,T as mt,U as R,j as it,W as xt,X as gt,Y as bt,f as st,Z as kt,_ as $t,$ as J,s as St,a0 as Ut,a1 as Tt,a2 as Pt}from"./index-xpF7dIu9.js";import{b as N,_ as Lt}from"./MusicList-57iRDOC5.js";function Ct(s,t,e){var o=e||{},c=o.noTrailing,r=c===void 0?!1:c,d=o.noLeading,a=d===void 0?!1:d,l=o.debounceMode,_=l===void 0?void 0:l,f,p=!1,b=0;function H(){f&&clearTimeout(f)}function j(m){var v=m||{},x=v.upcomingOnly,Q=x===void 0?!1:x;H(),p=!Q}function y(){for(var m=arguments.length,v=new Array(m),x=0;x<m;x++)v[x]=arguments[x];var Q=this,tt=Date.now()-b;if(p)return;function I(){b=Date.now(),t.apply(Q,v)}function et(){f=void 0}!a&&_&&!f&&I(),H(),_===void 0&&tt>s?a?(b=Date.now(),r||(f=setTimeout(_?et:I,s))):I():r!==!0&&(f=setTimeout(_?et:I,_===void 0?s-tt:s))}return y.cancel=j,y}function Ht(s,t,e){var o=e||{},c=o.atBegin,r=c===void 0?!1:c;return Ct(s,t,{debounceMode:r!==!1})}const C=ut("searchState",()=>({state:dt({query:"",isSearch:!1,searchHistory:wt(A)})})),Mt={class:"tw-flex tw-h-full tw-items-center tw-px-3"},Vt={class:"tw-flex tw-flex-1 tw-bg-white tw-mx-2 tw-h-8 tw-items-center tw-rounded-2xl tw-px-3 tw-border-solid tw-border-[1px] tw-border-slate-300"},qt=["placeholder"],Dt={__name:"search-input",props:{placeholder:{type:String,default:"搜索歌曲、歌手"}},setup(s){const t=C(),e=k(t.state.query);q(e,Ht(300,a=>{t.state.query=a})),ht(()=>{e.value=t.state.query});const o=()=>{t.state.query="",t.state.isSearch=!1,e.value=""},c=()=>{e.value?o():(history.back(),t.state.isSearch=!1)},r=()=>{e.value&&(t.state.isSearch=!0)},d=()=>{t.state.isSearch=!1};return(a,l)=>(w(),h("div",Mt,[u(B,{size:"30",icon:"mdi-arrow-left",onClick:c}),n("div",Vt,[u(B,{size:"23",icon:"mdi-magnify",class:"tw-opacity-60 tw-mr-2"}),$(n("input",{class:"tw-flex-1 tw-box-border tw-outline-none tw-text-lg",placeholder:s.placeholder,"onUpdate:modelValue":l[0]||(l[0]=_=>Y(e)?e.value=_:null),onFocus:d},null,40,qt),[[ft,i(e)]]),$(n("span",null,[u(B,{size:"23",icon:"mdi-close-circle",class:"tw-opacity-30",onClick:o})],512),[[P,i(e)]])]),n("span",{class:"tw-text-lg tw-ml-1 tw-text-nowrap",onClick:r},"搜索")]))}},Bt=()=>G.get("search/hot/detail"),Et=s=>G.get("search/suggest",{params:{keywords:s,type:"mobile"}}),at=(s,t,e,o=15)=>G.get("search/",{params:{keywords:s,limit:o,offset:e,type:t}}),Ot={class:"tw-h-full tw-w-full tw-flex tw-flex-col tw-mt-14"},It={class:"tw-ml-6 tw-text-lg tw-mt-3"},zt=["onClick"],Rt=["innerHTML"],At="正在载入...",Yt={__name:"suggest",setup(s){const t=C(),e=T(()=>t.state.query),o=k([]),{pending:c,execute:r}=E(()=>Et(e.value).then(l=>{o.value=l.data.result.allMatch}),[],!1);X(()=>{r()}),q(e,l=>{l&&(t.state.query=l,o.value=[],r())});const d=l=>{t.state.query=l,t.state.isSearch=!0},a=()=>{t.state.query=""};return(l,_)=>{const f=Z("loading");return $((w(),h("div",Ot,[$(n("div",It,"暂无搜索建议...",512),[[P,!i(o)&&!i(c)]]),(w(!0),h(L,null,V(i(o),p=>(w(),h("div",{class:"tw-h-12 tw-flex tw-items-center",key:p.keyword,onClick:b=>d(p.keyword)},[u(B,{size:"23",icon:"mdi-magnify",class:"tw-opacity-60 tw-ml-5 tw-mr-2"}),n("span",{class:"tw-flex-1 tw-border-solid tw-border-t-0 tw-border-l-0 tw-border-r-0 tw-border-slate-300 tw-border-b-[1px] tw-text-lg tw-leading-10 tw-line-clamp-1",innerHTML:i(N)(p.keyword,i(e))},null,8,Rt)],8,zt))),128)),n("div",{class:"tw-w-full tw-flex-1",onClick:_[0]||(_[0]=p=>a())})])),[[f,i(c),At]])}}},ot=s=>G.get("song/detail",{params:{ids:s}}),Ft={class:""},Nt=["onClick"],Wt=["src"],Gt={class:"tw-flex tw-flex-col tw-py-1 tw-ml-3"},Kt=["innerHTML"],jt={class:"tw-line-clamp-1"},Qt={class:"tw-text-sm tw-opacity-80"},Jt={key:0},Xt=["innerHTML"],Zt={__name:"Playlists",props:{playlists:{type:Array,default:[]}},setup(s){const t=C(),e=T(()=>t.state.query),o=rt(),c=r=>{o.push({name:"playlistDetail",params:{id:r}})};return(r,d)=>(w(),h("div",Ft,[(w(!0),h(L,null,V(s.playlists,a=>(w(),h("div",{class:"tw-flex tw-mr-2",key:a==null?void 0:a.id,onClick:l=>c(a.id)},[n("img",{class:"tw-h-16 tw-w-16 tw-rounded-xl tw-my-2",src:a==null?void 0:a.coverImgUrl},null,8,Wt),n("div",Gt,[n("div",{class:"tw-text-base tw-my-2 tw-line-clamp-1 tw-font-medium",innerHTML:i(N)(a==null?void 0:a.name,i(e))},null,8,Kt),n("div",jt,[$(n("span",{class:"tw-inline-block tw-text-red-500 tw-text-center tw-w-fit tw-border-solid tw-border-[1px] tw-rounded tw-text-xs tw-font-medium tw-border-red-300 tw-leading-[14px] tw-mr-1"},U(a==null?void 0:a.score)+"分 ",513),[[P,(a==null?void 0:a.score)!==null]]),n("span",Qt,U(a==null?void 0:a.trackCount)+"首 ,by "+U(a==null?void 0:a.creator.nickname)+" ,播放"+U(a==null?void 0:a.playCount)+"次",1)]),(a==null?void 0:a.officialTags)!==null?(w(),h("div",Jt,[(w(!0),h(L,null,V(a==null?void 0:a.officialTags,l=>(w(),h("span",{key:l.id,class:"tw-text-orange-600 tw-bg-orange-100 tw-text-[11px] tw-w-fit tw-max-w-[263px] tw-px-1 tw-leading-5 tw-rounded-sm tw-mt-1 tw-mr-2"},U(l),1))),128))])):(w(),h(L,{key:1},[(a==null?void 0:a.recommendText)!==null?(w(),h("div",{key:0,class:"tw-opacity-80",innerHTML:i(N)(a==null?void 0:a.recommendText,i(e))},null,8,Xt)):K("",!0)],64))])],8,Nt))),128))]))}},te={class:"tw-flex tw-flex-col"},ee=["onClick"],se={class:"tw-h-14 tw-w-14 tw-rounded-full tw-mr-2"},ae={class:"tw-w-full tw-flex tw-flex-1 tw-justify-between tw-items-center tw-border-solid tw-border-t-0 tw-border-l-0 tw-border-r-0 tw-border-b-[1px] tw-border-slate-200 tw-pb-1"},oe=["innerHTML"],le={key:0,class:"tw-text-sky-600"},ne=n("div",null,[n("div",{class:"tw-transition-all tw-ease-in-out tw-text-xs tw-border-solid tw-rounded-3xl tw-border-[1px] tw-mr-8 tw-py-1 tw-px-2 tw-text-red-500"}," + 关注")],-1),re={__name:"SingerList",props:{singers:{type:Array,default:[]}},setup(s){const t=C(),e=T(()=>t.state.query),o=rt(),c=r=>{o.push({name:"artist",params:{id:r}})};return(r,d)=>{const a=Z("lazy");return w(),h("div",te,[(w(!0),h(L,null,V(s.singers,l=>(w(),h("div",{key:l==null?void 0:l.id,class:"tw-flex tw-items-center tw-my-2",onClick:_=>c(l==null?void 0:l.id)},[n("div",null,[$(n("img",se,null,512),[[a,l==null?void 0:l.picUrl]])]),n("div",ae,[n("div",null,[n("span",{class:"tw-text-base tw-font-medium tw-mb-1 tw-line-clamp-1",innerHTML:i(N)(l==null?void 0:l.name,i(e))},null,8,oe),(l==null?void 0:l.fansGroup)!==null?(w(),h("span",le,U(l==null?void 0:l.fansGroup.text)+" > ",1)):K("",!0)]),ne])],8,ee))),128))])}}};/*!
 * better-scroll / pull-up
 * (c) 2016-2023 ustbhuangyi
 * Released under the MIT License.
 */var O=typeof window<"u",W=O&&navigator.userAgent.toLowerCase();W&&W.indexOf("android")>0;(function(){if(typeof W=="string"){var s=/os (\d\d?_\d(_\d)?)/,t=s.exec(W);if(!t)return!1;var e=t[1].split("_").map(function(o){return parseInt(o,10)});return e[0]===13&&e[1]>=4}return!1})();var ie=!1;if(O){var ce="test-passive";try{var lt={};Object.defineProperty(lt,"passive",{get:function(){ie=!0}}),window.addEventListener(ce,function(){},lt)}catch{}}var ue=function(s,t){for(var e in t)s[e]=t[e];return s},ct=O&&document.createElement("div").style,M=function(){if(!O)return!1;for(var s=[{key:"standard",value:"transform"},{key:"webkit",value:"webkitTransform"},{key:"Moz",value:"MozTransform"},{key:"O",value:"OTransform"},{key:"ms",value:"msTransform"}],t=0,e=s;t<e.length;t++){var o=e[t];if(ct[o.value]!==void 0)return o.key}return!1}();function S(s){return M===!1?s:M==="standard"?s==="transitionEnd"?"transitionend":s:M+s.charAt(0).toUpperCase()+s.substr(1)}M&&M!=="standard"&&""+M.toLowerCase();var de=S("transform"),we=S("transition");O&&S("perspective")in ct;S("transitionTimingFunction"),S("transitionDuration"),S("transitionDelay"),S("transformOrigin"),S("transitionEnd"),S("transitionProperty");var he="plugins.pullUpLoad",fe=[{key:"finishPullUp",name:"finishPullUp"},{key:"openPullUp",name:"openPullUp"},{key:"closePullUp",name:"closePullUp"},{key:"autoPullUpLoad",name:"autoPullUpLoad"}],pe=fe.map(function(s){return{key:s.key,sourceKey:he+"."+s.name}}),nt="pullingUp",ve=function(){function s(t){this.scroll=t,this.pulling=!1,this.watching=!1,this.init()}return s.prototype.init=function(){this.handleBScroll(),this.handleOptions(this.scroll.options.pullUpLoad),this.handleHooks(),this.watch()},s.prototype.handleBScroll=function(){this.scroll.registerType([nt]),this.scroll.proxy(pe)},s.prototype.handleOptions=function(t){t===void 0&&(t={}),t=t===!0?{}:t;var e={threshold:0};this.options=ue(e,t),this.scroll.options.probeType=3},s.prototype.handleHooks=function(){var t=this;this.hooksFn=[];var e=this.scroll.scroller.scrollBehaviorY;this.registerHooks(this.scroll.hooks,this.scroll.hooks.eventTypes.contentChanged,function(){t.finishPullUp()}),this.registerHooks(e.hooks,e.hooks.eventTypes.computeBoundary,function(o){o.maxScrollPos>0&&(o.maxScrollPos=-1)})},s.prototype.registerHooks=function(t,e,o){t.on(e,o,this),this.hooksFn.push([t,e,o])},s.prototype.watch=function(){this.watching||(this.watching=!0,this.registerHooks(this.scroll,this.scroll.eventTypes.scroll,this.checkPullUp))},s.prototype.unwatch=function(){this.watching=!1,this.scroll.off(this.scroll.eventTypes.scroll,this.checkPullUp)},s.prototype.checkPullUp=function(t){var e=this,o=this.options.threshold;this.scroll.movingDirectionY===1&&t.y<=this.scroll.maxScrollY+o&&(this.pulling=!0,this.scroll.once(this.scroll.eventTypes.scrollEnd,function(){e.pulling=!1}),this.unwatch(),this.scroll.trigger(nt))},s.prototype.finishPullUp=function(){var t=this;this.scroll.scroller.scrollBehaviorY.setMovingDirection(0),this.pulling?this.scroll.once(this.scroll.eventTypes.scrollEnd,function(){t.watch()}):this.watch()},s.prototype.openPullUp=function(t){t===void 0&&(t={}),this.handleOptions(t),this.watch()},s.prototype.closePullUp=function(){this.unwatch()},s.prototype.autoPullUpLoad=function(){var t=this.options.threshold,e=this.scroll.scroller.scrollBehaviorY;if(!(this.pulling||!this.watching)){var o=-1,c=e.maxScrollPos+t+o;this.scroll.scroller.scrollBehaviorY.setMovingDirection(o),this.scroll.scrollTo(this.scroll.x,c,this.scroll.options.bounceTime)}},s.pluginName="pullUpLoad",s}();F.use(ve);F.use(pt);function _e(s,t){const e=k(null),o=k(null),c=k(!1);return X(()=>{const r=e.value=new F(o.value,{pullUpLoad:!0,observeDOM:!0,click:!0});r.on("pullingUp",d);async function d(){if(t.value){r.finishPullUp();return}c.value=!0,await s(),r.finishPullUp(),r.refresh(),c.value=!1}}),q(o,r=>{const d=e.value=new F(o.value,{pullUpLoad:!0,observeDOM:!0,click:!0});d.on("pullingUp",a);async function a(){if(t.value){d.finishPullUp();return}c.value=!0,await s(),d.finishPullUp(),d.refresh(),c.value=!1}}),vt(()=>{e.value.destroy()}),{scroll:e,rootRef:o,isPullUpLoad:c}}const ye={class:"tw-h-full"},me={class:"tw-z-50 tw-bg-white"},xe={class:"tw-h-full"},ge={class:"tw-w-full tw-h-full tw-bg-white"},be={class:"tw-pb-8"},ke={key:0,class:"tw-w-full tw-h-8 tw-text-black tw-text-center tw-text-base"},$e={class:"tw-pb-8"},Se={class:"tw-w-full tw-h-8 tw-text-black tw-text-center tw-text-base"},Ue={class:"tw-pb-8"},Te={class:"tw-w-full tw-h-8 tw-text-black tw-text-center tw-text-base"},Pe="正在载入...",Le={__name:"result",props:{query:{type:String,default:""}},setup(s){const t=k("1"),e=k(0),o=k([]),c=k([]),r=k([]),d=k(!1),a=k(!1),l=s,{rootRef:_,isPullUpLoad:f}=_e(j,a),{data:p,pending:b,execute:H}=E(()=>at(l.query,t.value,e.value).then(y=>{if(t.value==="1"){let m="";for(let v=0;v<y.data.result.songs.length;v++){const x=y.data.result.songs[v].id+"";v===0?m+=x:m+=","+x}E(()=>ot(m).then(v=>{o.value=v.data.songs}))}else t.value==="1000"?c.value=y.data.result.playlists:t.value==="100"&&(r.value=y.data.result.artists);return d.value=y.data.result.hasMore,y.data.result}),{},!1);X(()=>{H()}),q(t,y=>{y&&(e.value=0,H())});async function j(){d.value&&(e.value++,await at(l.query,t.value,e.value).then(y=>{if(t.value==="1"){let m="";for(let v=0;v<y.data.result.songs.length;v++){const x=y.data.result.songs[v].id+"";v===0?m+=x:m+=","+x}E(()=>ot(m).then(v=>{o.value=o.value.concat(v.data.songs)}))}else t.value==="1000"?c.value=c.value.concat(y.data.result.playlists):t.value==="100"&&(r.value=r.value.concat(y.data.result.artists));d.value=y.data.result.hasMore}))}return(y,m)=>{const v=Z("loading");return $((w(),h("div",ye,[u(it,{class:"h-100"},{default:g(()=>[n("div",me,[u(_t,{color:"red-lighten-2",height:"30",modelValue:i(t),"onUpdate:modelValue":m[0]||(m[0]=x=>Y(t)?t.value=x:null),"bg-color":"white"},{default:g(()=>[u(z,{value:"1"},{default:g(()=>[D("单曲")]),_:1}),u(z,{value:"1000"},{default:g(()=>[D("歌单")]),_:1}),u(z,{value:"100"},{default:g(()=>[D("歌手")]),_:1}),u(z,{value:"1002"},{default:g(()=>[D("用户")]),_:1})]),_:1},8,["modelValue"])]),n("div",xe,[n("div",ge,[u(yt,{class:"pl-5 pr-0 h-100 py-0"},{default:g(()=>[u(mt,{class:"h-100",modelValue:i(t),"onUpdate:modelValue":m[1]||(m[1]=x=>Y(t)?t.value=x:null)},{default:g(()=>[u(R,{class:"h-100",value:"1"},{default:g(()=>[n("div",{ref_key:"rootRef",ref:_,class:"scroll MusicList tw-pt-1 tw-h-full"},[n("div",be,[u(Lt,{songs:i(o),"has-index":!1,isHightLight:!0,keyWord:s.query},null,8,["songs","keyWord"]),i(f)&&i(d)?(w(),h("div",ke," 正在载入... ")):K("",!0)])],512)]),_:1}),u(R,{class:"h-100",value:"1000"},{default:g(()=>[n("div",{ref_key:"rootRef",ref:_,class:"scroll playlists tw-pt-1 tw-h-full"},[n("div",$e,[u(Zt,{playlists:i(c)},null,8,["playlists"]),$(n("div",Se," 正在载入... ",512),[[P,i(f)&&i(d)]])])],512)]),_:1}),u(R,{class:"h-100",value:"100"},{default:g(()=>[n("div",{ref_key:"rootRef",ref:_,class:"scroll Singerlist tw-pt-1 tw-h-full"},[n("div",Ue,[u(re,{singers:i(r)},null,8,["singers"]),$(n("div",Te," 正在载入... ",512),[[P,i(f)&&i(d)]])])],512)]),_:1}),u(R,{value:"1002"},{default:g(()=>[D(" 待探索... ")]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),_:1})])),[[v,i(b),Pe]])}}};function Ce(){const t=C();function e(r){const d=xt(r,A,a=>a===r,10);t.state.searchHistory=d}function o(r){const d=gt(A,a=>a===r);t.state.searchHistory=d}function c(){bt(A)}return{saveSearch:e,deleteSearch:o,clearSearch:c}}const He={class:"tw-w-full tw-flex tw-justify-between"},Me=n("span",{class:"tw-font-semibold"},"搜索历史",-1),Ve={class:"tw-flex tw-justify-center"},qe={class:"tw-flex tw-flex-wrap tw-pl-2 tw-w-full"},De=["onClick"],Be={__name:"search-history",setup(s){const t=C(),e=T(()=>t.state.searchHistory),o=T(()=>t.state.isSearch),c=T(()=>t.state.query),r=k(!1),{saveSearch:d,clearSearch:a}=Ce();q(o,f=>{f===!0&&d(c.value)});const l=f=>{t.state.query=f,t.state.isSearch=!0},_=()=>{t.state.searchHistory=[],a(),r.value=!1};return(f,p)=>(w(),h(L,null,[n("div",He,[Me,u(B,{class:"tw-opacity-50",icon:"mdi-trash-can-outline",onClick:p[0]||(p[0]=b=>r.value=!0)}),u(kt,{modelValue:i(r),"onUpdate:modelValue":p[2]||(p[2]=b=>Y(r)?r.value=b:null),width:"auto"},{default:g(()=>[u(it,{class:"rounded-xl tw-text-center",width:"200",height:"100",text:"是否清空搜索历史"},{default:g(()=>[n("div",Ve,[u(st,{class:"tw-flex-1",text:"取消",onClick:p[1]||(p[1]=b=>r.value=!1)}),u(st,{class:"tw-flex-1",text:"清空",onClick:_})])]),_:1})]),_:1},8,["modelValue"])]),n("div",qe,[(w(!0),h(L,null,V(i(e),b=>(w(),h("div",{class:"tw-mr-2 tw-my-2 tw-rounded-3xl tw-px-3 tw-bg-opacity-80 tw-bg-white tw-py-[2px] tw-max-w-40 tw-truncate tw-text-sm",onClick:H=>l(b)},U(b),9,De))),256))])],64))}},Ee=s=>(Tt("data-v-c4f9dbf8"),s=s(),Pt(),s),Oe={class:"tw-fixed tw-top-0 tw-bottom-0 tw-left-0 tw-right-0 tw-bg-slate-200 tw-flex tw-flex-col"},Ie={class:"search-content tw-h-full"},ze={class:"tw-h-fit tw-pt-12 tw-pb-2"},Re={key:"'searchHistory'",class:"tw-mx-5 tw-pt-4"},Ae={key:"'hot'",class:"hot tw-bg-white tw-rounded-2xl tw-mx-5 tw-px-4 tw-pb-1 tw-pt-4 tw-mt-4"},Ye=Ee(()=>n("div",{class:"tw-pb-3 tw-border-b-[1px] tw-border-t-0 tw-border-l-0 tw-border-r-0 tw-border-solid tw-border-b-slate-200"},[n("span",{class:"tw-font-bold tw-text-xl"}," 热搜榜 ")],-1)),Fe=["onClick"],Ne=["src"],We={class:"search-suggest tw-h-full"},Ge={key:0,class:"search-result tw-h-full"},Ke={class:"wrapper tw-pt-14 tw-h-full"},je={__name:"search",setup(s){const t=T(()=>e.state.searchHistory),e=C(),o=T(()=>e.state.query),c=T(()=>e.state.isSearch);q(o,l=>{e.state.query=l});const{data:r,pending:d}=E(()=>Bt().then(l=>l.data.data),{}),a=l=>{e.state.query=l,e.state.isSearch=!0};return(l,_)=>(w(),h("div",Oe,[n("div",{class:J(["tw-fixed tw-left-0 tw-top-0 tw-right-0 tw-h-14 tw-z-50 tw-bg-slate-200",{"tw-bg-white":i(o)&&i(c)}])},[u(Dt)],2),$(n("div",Ie,[u(St,{class:"scroll tw-h-full"},{default:g(()=>[n("div",ze,[u(Ut,{appear:"",tag:""},{default:g(()=>[$(n("div",Re,[u(Be)],512),[[P,i(t).length]]),n("div",Ae,[Ye,n("div",null,[(w(!0),h(L,null,V(i(r),(f,p)=>(w(),h("div",{class:"tw-my-2 tw-flex tw-items-center",key:p,onClick:b=>a(f.searchWord)},[n("span",{class:J(["tw-text-xl tw-text-opacity-80 tw-w-8",{"tw-text-red-500 tw-font-bold":p<3}])},U(p+1),3),n("span",{class:J(["tw-mr-1",{"tw-font-bold":p<3}])},U(f.searchWord),3),n("img",{class:"tw-h-4",src:f.iconUrl},null,8,Ne)],8,Fe))),128))])])]),_:1})])]),_:1})],512),[[P,!i(o)]]),$(n("div",We,[u(Yt)],512),[[P,i(o)&&!i(c)]]),i(c)?(w(),h("div",Ge,[n("div",Ke,[u(Le,{query:i(o)},null,8,["query"])])])):K("",!0)]))}},Xe=$t(je,[["__scopeId","data-v-c4f9dbf8"]]);export{Xe as default};
